name: CI
on: [push, pull_request, workflow_dispatch]

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [windows-latest, ubuntu-latest, macos-13, macos-14]
      fail-fast: false
    steps:
    - uses: actions/checkout@v4
    - name: Fetch all history for all tags and branches
      run: |
        git fetch --prune --unshallow
    - uses: gittools/actions/gitversion/setup@v0.12
      name: Install GitVersion
      with:
        versionSpec: '6.x'
        includePrerelease: true
    - uses: gittools/actions/gitversion/execute@v0.12
      name: Use GitVersion
      id: gitversion # step id used as reference for output values
    - run: |
        echo "FullSemVer (env.fullSemVer)                                 : ${{ env.fullSemVer }}"
        echo "FullSemVer (env.GitVersion_FullSemVer)                      : ${{ env.GitVersion_FullSemVer }}"
        echo "FullSemVer (steps.gitversion.outputs.fullSemVer)            : ${{ steps.gitversion.outputs.fullSemVer }}"
        echo "FullSemVer (steps.gitversion.outputs.GitVersion_FullSemVer) : ${{ steps.gitversion.outputs.GitVersion_FullSemVer }}"
      name: Use variables and output